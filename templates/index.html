<!DOCTYPE html>
<html lang="en" class="scroll-smooth" id="htmlRoot">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mallu Video Chat</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ffffff" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png">

  <!-- Tailwind CSS -->
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    video { border-radius: 1rem; background: black; }
    #chatMessages { overflow-y: auto; }
    #loader { backdrop-filter: blur(4px); }
  </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col items-center justify-start p-4 sm:p-6">

  <!-- âœ… Online User Count -->
  <div id="onlineCount" class="fixed top-4 right-4 bg-green-600 text-white text-xs sm:text-sm px-3 py-1.5 rounded-full shadow-lg z-50">
    Online: 0
  </div>

  <!-- ðŸ”„ Loader -->
  <div id="loader" class="fixed inset-0 bg-white dark:bg-gray-900 bg-opacity-80 flex flex-col items-center justify-center z-50 hidden">
    <div class="w-12 h-12 border-4 border-blue-500 border-dashed rounded-full animate-spin mb-4"></div>
    <p class="text-lg font-semibold">Finding a stranger...</p>
  </div>

  <!-- ðŸŒ Main Chat Box -->
  <div class="w-full max-w-2xl bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-5 sm:p-8 space-y-6">

    <!-- ðŸ”° Header -->
    <div class="text-center">
      <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-600 dark:text-blue-400">Mallu Video Chat</h1>
      <p id="statusBar" class="mt-1 text-sm text-gray-500 dark:text-gray-400">ðŸ”„ Status: Waiting...</p>
      <button onclick="toggleDarkMode()" class="mt-2 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-500 dark:hover:text-yellow-300 transition">
        ðŸŒ™ Toggle Dark Mode
      </button>
    </div>

    <!-- ðŸŽ¥ Video Streams -->
    <div id="videos" class="space-y-4">
      <video id="localVideo" autoplay muted playsinline class="w-full aspect-video bg-black rounded-xl shadow-md"></video>
      <video id="remoteVideo" autoplay playsinline class="w-full aspect-video bg-black rounded-xl shadow-md"></video>
    </div>

    <!-- ðŸŽ›ï¸ Controls -->
    <div class="flex flex-wrap justify-center gap-3">
      <button onclick="toggleMic()" id="micBtn" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-medium transition">ðŸŽ¤ Mute</button>
      <button onclick="toggleCam()" id="camBtn" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-medium transition">ðŸ“· Camera Off</button>
      <button onclick="disconnectCall()" class="bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-full text-sm font-medium transition">ðŸ”´ Disconnect</button>
    </div>

    <!-- ðŸ’¬ Chat Area -->
    <div class="space-y-2">
      <div id="chatMessages" class="bg-gray-200 dark:bg-gray-700 p-4 rounded-xl h-40 sm:h-48 text-sm overflow-y-auto space-y-2"></div>
      <div class="flex gap-2">
        <input type="text" id="chatInput" placeholder="Type a message..." class="flex-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 px-4 py-2 rounded-full focus:outline-none text-sm" />
        <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-full text-sm transition">Send</button>
      </div>
    </div>

    <!-- ðŸ‘¥ Gender Selection -->
    <div class="flex justify-center gap-4">
      <button id="maleBtn" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-6 py-2 rounded-full text-sm font-semibold transition">ðŸ‘¨ Male</button>
      <button id="femaleBtn" class="bg-pink-100 hover:bg-pink-200 text-pink-700 px-6 py-2 rounded-full text-sm font-semibold transition">ðŸ‘© Female</button>
    </div>

    <!-- ðŸ’¸ QR Message -->
    <div id="qrMessage" class="hidden text-center mt-4 text-sm text-pink-600 dark:text-pink-400 space-y-2">
      <p>ðŸ‘© Female option requires a one-time verification fee.<br>Scan the QR below to continue:</p>
      <img src="/static/60.png" alt="Payment QR" class="w-40 mx-auto rounded-lg border border-gray-300 dark:border-gray-600 shadow" />
    </div>

    <!-- ðŸ” Connect Button -->
    <div class="text-center pt-2">
      <button onclick="findStranger()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-full text-base font-semibold shadow-md transition">
        ðŸ”„ Connect to Stranger
      </button>
    </div>
  </div>

  <!-- ðŸ“„ Footer -->
  <footer class="mt-10 text-center text-xs text-gray-400 dark:text-gray-500 pt-4 w-full max-w-2xl border-t border-gray-300 dark:border-gray-700">
    <p class="mb-2">
      By using this service, you agree to our
      <a href="#" class="text-blue-500 dark:text-blue-400 underline hover:text-blue-600 dark:hover:text-blue-300">Terms</a> and
      <a href="#" class="text-blue-500 dark:text-blue-400 underline hover:text-blue-600 dark:hover:text-blue-300">Privacy Policy</a>.
    </p>
    <p>&copy; 2025 Mallu Video Chat. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <!-- (All your JS remains unchanged) -->
</body>
</html>
